{
  "db_name": "PostgreSQL",
  "query": "\n            WITH selected_devices AS (\n                SELECT d.id FROM device d\n                JOIN release r ON d.release_id = r.id\n                LEFT JOIN device_label dl ON dl.device_id = d.id\n                LEFT JOIN label l ON l.id = dl.label_id\n                WHERE\n                    (CARDINALITY($3::text[]) = 0 OR l.name || '=' || dl.value = ANY($3))\n                    AND d.release_id = d.target_release_id\n                    AND r.distribution_id = $1\n            )\n            INSERT INTO deployment_devices (deployment_id, device_id)\n            SELECT $2, id FROM selected_devices\n            \n            ",
  "describe": {
    "columns": [],
    "parameters": {
      "Left": [
        "Int4",
        "Int4",
        "TextArray"
      ]
    },
    "nullable": []
  },
  "hash": "5b12b990e21b0ba21845c63fd549d5b2453838eb9d0731baeac1a5f6d637fbb3"
}
